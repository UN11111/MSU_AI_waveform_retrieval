# MSU_AI_waveform_retrieval

# Разработка нейросетевой модели восстановления спектрально-временной формы терагерцевого (ТГц) импульса по сигналу ТГц-индуцированной второй гармоники.
В рамках данного проекта предложен и продемонстрирован метод восстановления спектра и временной формы поля терагерцевого импульса на основе измерения сигнала второй оптической гармоники, генерируемой в газовой среде при двухцветном воздействии терагерцевого импульса и фемтосекундного инфракрасного лазерного излучения. Для восстановления спектрально-временной формы тергерцевого излучения использована предобученная на синтезированных данных полносвязная нейронная сеть, принимающая на вход измеряемую зависимость сигнала второй гармоники от задержки между инфракрасным и терагерцевым 
импульсами.

# Данные
В качестве данных для обучения и валидации используются синтезированные данные, представляющие собой набор зависимостей энергии второй гармоники от задержки между ТГц- и ИК-импульсами, подаваемых на вход нейросети, и соответствующих им параметров, описывающих спектрально-временную форму ТГц-импульса, представляющих собой выходные параметры нейросети. Для формирования устойчивости процесса восстановления на основе реальных экспериментальных сигналов в синтезированный сигнал добавляется шум с равномерным распределением в диапазоне ±2% от амплитуды сигнала второй гармоники, что отвечает реальной экспериментальной ситуации. Для организации процесса обучения нейросети проводилась нормировка данных с приведением их к диапазону [-1;1] и там, где это было более физически корректно, к диапазону [0;1]. 

# Методология
Задача восстановления спектрально-временной формы ТГц-импульса решалась в двух приближения. В рамках первого приближения для описания спектрально-временной формы импульса использовались три параметра, в рамках второго приближения - шесть. Для восстановления данных параметров, характеризующих форму импульса, использовалась нейронная сеть, обученная на синтезированых данных. Архитектура используемой нейросети представлена на рисунке ниже.

![alt text](https://github.com/UN11111/MSU_AI_waveform_retrieval/blob/main/%D0%90%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0%20%D0%BD%D0%B5%D0%B9%D1%80%D0%BE%D0%BD%D0%BD%D0%BE%D0%B9%20%D1%81%D0%B5%D1%82%D0%B8.png)
## Параметры обучения:
- Оптимизатор Adam;
- Функция потерь L1Loss (MAE);
- batch_size = 256 (1-е приближение) и 16384 (2-е приближение)
## Метрика качества:
- MAE

Файлы, относящиеся к решению задачи в первом приближении, представлены в папке "Single peak", во втором приближении - в папке "Two peaks". 
Код с обучением модели представлен в файлах "Single peak v2.ipynb" и "Two peaks v1.ipynb" для 1-го и 2-го приближений соответственно.
Код для проверки модели на тестовой выборке и представлен в файлах "Single peak тестирование модели.ipynb" и "Two peaks тестирование модели.ipynb" для 1-го и 2-го приближений соответственно

Работа выполнялась в среде Yandex Datasphere.

 
